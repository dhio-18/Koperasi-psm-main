#!/bin/bash
# Quick Setup Guide for Production Deployment
# Run this after all files are created

echo "================================================"
echo "Koperasi PSM - Production Deployment Setup"
echo "================================================"
echo ""

echo "üìã Files Created:"
echo "‚úì .env.production               - Production configuration"
echo "‚úì .github/workflows/deploy.yml  - GitHub Actions CI/CD workflow"
echo "‚úì deploy.sh                     - Deployment script (run on server)"
echo "‚úì rollback.sh                   - Rollback script (if needed)"
echo "‚úì health-check.sh               - Health check monitoring"
echo "‚úì DEPLOYMENT.md                 - Detailed deployment guide"
echo "‚úì GITHUB_SECRETS_SETUP.md       - Secrets configuration guide"
echo "‚úì DEPLOYMENT_CHECKLIST.md       - Pre-deployment checklist"
echo ""

echo "‚ö†Ô∏è  IMPORTANT: DO NOT COMMIT PRIVATE KEY!"
echo ""

echo "üîê Next Steps:"
echo "1. Generate SSH key pair:"
echo "   ssh-keygen -t rsa -b 4096 -f deploy_key -N ''"
echo ""
echo "2. Add secrets to GitHub:"
echo "   Go to: Settings ‚Üí Secrets and variables ‚Üí Actions"
echo "   Add these secrets:"
echo "   ‚Ä¢ DEPLOY_KEY (content of deploy_key file)"
echo "   ‚Ä¢ SERVER_HOST"
echo "   ‚Ä¢ SERVER_USER"
echo "   ‚Ä¢ SERVER_PATH"
echo "   ‚Ä¢ DB_HOST"
echo "   ‚Ä¢ DB_PORT"
echo "   ‚Ä¢ DB_DATABASE"
echo "   ‚Ä¢ DB_USERNAME"
echo "   ‚Ä¢ DB_PASSWORD"
echo "   ‚Ä¢ SLACK_WEBHOOK (optional)"
echo ""

echo "3. Setup production server:"
echo "   - Create deployment user: sudo useradd -m -s /bin/bash deploy"
echo "   - Add SSH public key to authorized_keys"
echo "   - Create app directory: sudo mkdir -p /var/www/koperasi-psm"
echo "   - Install dependencies: PHP 8.2, MySQL, Node.js"
echo "   - Setup database and user"
echo "   - Configure Nginx with SSL"
echo ""

echo "4. Make scripts executable:"
echo "   chmod +x deploy.sh rollback.sh health-check.sh"
echo ""

echo "5. Configure .env.production:"
echo "   - Update APP_URL"
echo "   - Update Google OAuth credentials"
echo "   - Update database details"
echo "   - Update email credentials"
echo ""

echo "6. Commit and push:"
echo "   git add .github/ .env.production *.sh *.md"
echo "   git commit -m 'chore: add production deployment files'"
echo "   git push origin main"
echo ""

echo "üìö Documentation Files:"
echo "   ‚Ä¢ DEPLOYMENT.md              - Complete setup and troubleshooting"
echo "   ‚Ä¢ GITHUB_SECRETS_SETUP.md    - How to configure secrets safely"
echo "   ‚Ä¢ DEPLOYMENT_CHECKLIST.md    - Pre-deployment verification"
echo ""

echo "üöÄ To Deploy:"
echo "   ‚Ä¢ Push to main branch"
echo "   ‚Ä¢ GitHub Actions will automatically run deploy.yml"
echo "   ‚Ä¢ Monitor in Actions tab"
echo ""

echo "‚èÆÔ∏è  To Rollback (if needed):"
echo "   ssh deploy@SERVER_HOST"
echo "   cd /var/www/koperasi-psm"
echo "   bash rollback.sh"
echo ""

echo "‚úÖ Security Checklist:"
echo "   ‚úì Private key NOT in repository"
echo "   ‚úì All secrets in GitHub Secrets only"
echo "   ‚úì .env.production is configuration-only (no secrets)"
echo "   ‚úì SSH key pair generated (4096-bit RSA)"
echo "   ‚úì Strong database password (32+ characters)"
echo "   ‚úì .gitignore properly configured"
echo ""

echo "================================================"
echo "Setup Complete! Ready for production deployment"
echo "================================================"
